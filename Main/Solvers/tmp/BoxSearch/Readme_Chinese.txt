		BoxSearch5.0 仓库番(推箱子)工具 说明

	注意，如果运行程序时提示找不到某个dll文件，请到我的主页下载MFC库。
	http://notabdc.vip.sina.com/Soft/Mfc71.zip
	http://www.freewebs.com/gamesolver/Soft/Mfc71.zip
	下载后解压缩到与本程序相同的目录即可。

==最新更新
==怎样在其他推箱子游戏中调用BoxSearch进行求解
==软件的特色
==使用说明
==联系作者
==软件由来
==作者的其他软件
==推荐几款推箱子游戏

** 为专业开发者准备的信息 **
==怎样通过程序调用BoxSearch的算法
==仓库番(推箱子)求解算法简介
==BoxSearch的设计理念
==关于目标宏


==最新更新
	5.0版：
	求解算法内部使用了相当多的新技术，使得解关能力和解关速度又有不小的提高。
	支持插件模式运行，可以被其他推箱子游戏很方便地调用。
	
	4.1.3版：
	支持最大60×60的关卡。关卡显示可以伸缩和滚动。

	4.1.2版:
	“解答优化”功能中可以设定从第几步开始优化。

	4.1版：
	更好地支持LrUd格式的解答。
	增加“解答优化”功能。追求更少推动、更少移动的玩家有福了。注意，并不保证优化后的解答是最优解。要得到更好的解答，本质上依赖于原先的解答在总体思路上的把握。

	4.0版：
	加入“容量限制”检查。程序可以检测出一块区域中的箱子过多而导致的死锁。典型的例子就是靠墙的一排空地中箱子个数不能多于目标点的个数。
	对箱子推到位的次序进行简单的规划。
	更多考虑对同一箱子的连续移动。
	增加了三种求解模式：最优推动、最优推动且其次保证最优移动、最优移动且其次保证最优推动。求出来的是最优解。这些并非主要功能，存在不少提高的余地，有待今后完善。
	求解完成后，将文本格式(LRud)的答案送入剪贴板，便于同其他游戏程序交流。（5.0版中已经用专门的功能取代）
	程序技术上的提高。速度更快、内存消耗更少。

	3.1版：增加选项可以跳过“目标宏”两阶段搜索的其中的一个。这个功能的应用之一是：可以仅仅求解一个关卡中如何把箱子推到“目标区”，而不必求解整个关卡。关卡编辑功能略为改动，更方便一些。
	3.0版：算法中增加了“目标宏”功能。详见“关于目标宏”一节。
	2.0版：大幅度优化了界面。提供了“试玩”模式。求解算法中加入了“隧道检测”功能。
	1.0正式版：增加了“保存为文本格式”功能。
	1.0测试版：最初的版本。


==怎样在其他推箱子游戏中调用BoxSearch进行求解
	并不是所有游戏都支持调用BoxSearch进行求解，只有那些支持“Sokoban++ Solver SDK”的游戏才行。普通玩家不需要知道这个名词到底是什么，只需要查询游戏软件的说明并按照说明操作即可。一般来说它会告诉你将“插件DLL”（对于BoxSearch来说，就是BoxSearchPlugin.dll这个文件）拷贝到一个特定的目录，并在游戏软件中进行设置。对于BoxSearch，你还要保证将BoxSearch主程序（BoxSearch***.exe）拷贝到和插件DLL相同的目录下。
	BoxSearch发布时以下两个游戏程序支持“Sokoban++ Solver SDK”，因而可以调用BoxSearch求解算法：
	Sokoban YASC	http://sourceforge.net/projects/sokobanyasc
	Sokoban++ 		http://www.joriswit.nl/sokoban
	这两款游戏都是英文软件，普通玩家可以在国内下载站搜索下载。希望有更多的中文游戏支持！


==软件的特色
	对小型关卡非常高效。对于箱子数在6个以内的关卡或者10×10大小以内的题目，解出率接近100%，速度也非常快。
	提供和求解相关的“独门功能”。除了主算法（称为“快速模式”）外，还提供“最优推动”、“最优推动且其次保证最优移动”、“最优移动且其次保证最优推动”三种求最优解的功能。提供“解答优化”功能。很难找到在其他程序中有这些特殊功能。
	BoxSearch的求解算法有先进的死锁检测算法。死锁就是一旦把箱子推动到某些位置，一些箱子就再也无法推动或者无法推到目的点，比如四个箱子成2×2摆放。推箱子高手对何种情况引起死锁非常敏感，这样他们预先就知道决不能让某些局面形成，这也是高手高于常人的原因之一。我的工具能够检测出绝大部分这样的死锁，并且，由于对死锁的特征进行了高度提炼，能够检测出很多人也无法很快看穿的死锁。这样，工具的效率得到很大的提高。
	

==使用说明
	软件是全中文的（在非中文环境下则显示英语界面），很容易理解，因此不多做说明。如果您认为一些地方不够明确，请告诉我，我下次写入详细一点的说明。下面是一些细节。

	软件的主要目标是求出一个解，而不是求最优解。求最优解的几个功能需要消耗更多的时间和内存，请注意。

	在“文件”菜单下有“打开文本格式文件”和“保存为文本格式文件”的功能。很多网上的推箱子游戏用文本格式保存题目(文件后缀名一般是xsb)，因此工具提供了支持。工具支持的文本格式文件的格式是：
	每一行代表仓库的一行，不能有空行。
	空格或‘='表示地板。每行最后连续的地板可以省略。
	‘#’表示墙。
	‘@’表示人。
	‘$’表示箱子。
	‘.’表示目的点。
	‘*’表示在目的点上的箱子。
	‘+’或‘%’表示在目的点上的人。

	“编辑”菜单下的“目标人位置”是本工具的特色之一。在求解一些大型题目时，虽然不能直接使用本工具，但是可以把题目分解成若干个子目标，有些目标可以用工具求解。这时，仅仅把箱子推到位是不够的，往往要指定最终状态时人所在的位置。比如要让人通过一个充满箱子的通道，然后把箱子回复原状。这时这个命令就可以起作用，它指定最终状态时人必须在的位置。

	工具界面使用不同颜色表示墙、箱子和人。在显示解答时，以推动一次箱子为一步，期间的人的移动不计。此时所有人所能到的格子用绿色填满。

	在“试玩模式下”，移动人直接点击目标点即可，推动箱子的方法是鼠标右键点击箱子的目标点并且按住不放，然后点击左键。

	Stage目录下提供一些推箱子的关卡。后缀名是.xsb的关卡是文本格式，其他的则是BoxSearch专用格式。其中WVsoko目录下的关卡由20603(仓库大师游戏的作者)提供。Classic306目录下的关卡由金优转换。他的其他一些收藏整理或创作的关卡放在JinYou目录下。LiJinYu目录下的关卡由李金玉收集。在此向这些网友表示感谢。


==联系作者
	欢迎与作者交流推箱子的体会，程序方面或者游戏方面都可以。也欢迎报告程序的错误，此时最好能附上题目存档，并描述出错的情形。
	Email: notabdc@vip.sina.com
	主页：
		www.puzzle007.net
		http://notabdc.vip.sina.com/index.htm
	      
	声明：作者已经放弃 geyong@263.net notabdc@263.net sweeper@ynmail.com 这几个邮箱，请旧版软件的用户注意。


==软件由来
	我一直对各种经典益智游戏的电脑求解感兴趣，自行编制了很多求解程序。很多游戏的求解其实是很简单的，任何一名优秀的程序员都可以很快编出来，比如说24点、华容道，现在在网上也可以找到不少程序。对于这种简单类型的程序，我编程刚入门的时候编了不少，现在兴趣不大了。
	另有一些游戏的求解就不那么简单了，而且网上也找不到现有的程序，连解法讨论都没有。对此，我准备把我的求解程序完善后发表，希望对益智游戏爱好者有所帮助，也希望能够兴趣相投的程序爱好者能够交流一下。
	作者已经发表的求解工具有“自动扫雷”、“空当接龙工具”、“华容道工具”、“四川省工具”、“独立钻石工具”(解这个游戏的关键不在程序上，在于数学分析)。


==作者的其他软件
	1. 自动扫雷：和空当接龙工具能自动操作游戏一样，能够自动进行扫雷！目前最高版本1.31。
	2. 空当接龙工具：求解任何空当接龙游戏，并能够自动操作游戏。目前最高版本2.1。
	3. 扫雷俄罗斯：新式的扫雷游戏，非常有趣！目前最高版本1.1.1。
	4. 将族修改器：能够修改中国象棋软件“将族”的棋局，积分，悔棋等存盘信息。目前最高版本1.1。
	5. 著名中文阅读软件ReadBook的“文字校正”插件。非常遗憾，因为ReadBook迟迟不能出台新的插件标准，目前最高版本的“文字校正”插件不能在最新的ReadBook软件中使用。
	6. 自动俄罗斯方块。演示如何使用电脑人工智能打俄罗斯方块。对于学习俄罗斯方块的技巧也有帮助。目前最高版本2.0。
	7. 四川省工具。求解游戏“四川省”(请勿与“上海”混淆)。目前最高版本1.0。
	8. 华容道工具。提供“快速求解”和“求最优解”两种算法。目前最高版本2.0。
	9. 独立钻石。求解“独立钻石问题”。这是我和网友茅吉合作的作品。目前最高版本1.61。其中的求解算法是我写的，版本1.0。

	此外，在我的主页上还可以找到其他网友的作品：
	1. 魔方详解1.5版。
	2. 金优自动条块1.5版。主要演示俄罗斯方块的对战。
	3. 伤脑筋的十二块工具1.1版。
	4. 五魔方2.0版。十二面体的魔方。

	以上软件在我的主页上可以下载。


==推荐几款推箱子游戏
	SuperSoko。最好的中文推箱子游戏。其前身是“老封推箱子”。网址：www.supersoko.com 
	Sokoban YASC。最好的推箱子游戏。推荐给英文好的玩家。网址：http://sourceforge.net/projects/sokobanyasc。这个主页是为程序开发者服务的，普通玩家建议到国内的软件下载站搜索下载。

	
-------------以下为专业开发者准备-------------

==怎样通过程序调用BoxSearch的算法
	要调用BoxSearch的求解算法，你同时需要BoxSearch可执行文件和插件dll。两者必须放在相同目录下。插件Dll遵循Sokoban++的"Solver SDK"，可以从 http://www.joriswit.nl/sokoban/ 下载。

	
==仓库番(推箱子)求解算法简介
	推箱子游戏的求解难度比其他游戏高很多。有一些游戏有固定的解法，比如魔方。Windows经典小游戏扫雷可以总结出通用推理规则(请参见作者的“自动扫雷”中的说明)。一些游戏的搜索空间很小，可以用电脑蛮力求解，比如华容道，每一步只有两三种可能性。有一些游戏虽然搜索空间比较大，但是可以给电脑制定启发式搜索规则，让电脑比较“智能”地进行搜索，比如空当接龙，作者的空当接龙工具就是让电脑向着理顺牌的次序的方向前进。
	推箱子游戏的搜索空间极大，又没有合适的一般方法。人可以总结出一些模糊的规则，但是这些规则非常难以用程序语言描述。推箱子问题已经被证明是一种“NP-难的问题”，“NP-难的问题”是计算机领域中至今没有找到有效算法的一类著名难题。
	目前，根本不存在对所有推箱子问题都能有效求解的方法。网上现有的程序一般只能有效地解决10×10大小之内的题目。我的程序也不例外。


==BoxSearch的设计理念
	关注小型关卡。求解小型关卡更关注死锁检测，求解大型关卡更关注箱子的有计划调度。到目前为止BoxSearch更集中于前者。今后会逐渐为后者投入力量。
	自动处理。实际上程序内部有很多可调参数，有些关卡在公开发布的版本中解不出来，但是实际上调整一些参数后可以解出。但是特殊的参数设置会极大影响普通情况下的求解，对非专业用户来说这些参数的意义也是不可理解的。BoxSearch遵循“全自动”的原则。一般情况下无需进行任何设置，当有其他重要程序运行时，可以适当限制内存使用量。
	决不漏解。有一些优化技术把看上去不太可能的走法抛弃以换取速度。BoxSearch决不抛弃任何看似很不可能的走法，因而，BoxSearch有能力宣布关卡“证明无解”。当然这也有代价，那就是对大型关卡求解能力的减弱。


==关于目标宏
	所谓“目标宏”是模拟这样一种解题思路：很多关卡明显可以分成若干区域，有些区域集中了目标点，另一些区域则集中了很多箱子。对于这样的关卡，人的思路显然是个个击破，对于目标点集中的区域考虑如何按次序摆满所有的目标点；箱子集中的区域考虑如何“突围而出”，然后再把两者集中起来。
	推箱子工具可以模拟一种特殊情况下的目标宏，其条件是：
	1. 存在一个“断点”。所谓断点是，假如去掉仓库区域里的所有箱子，然后在“断点”放一个箱子，则这个箱子把整个仓库区域分成严格互不连通的两个部分。
	2. 初始状态时“断点”上不能有箱子，也不能是目标点。(如果有箱子或目标点的话，一般可以很容易手工改造成没有箱子或目标点的等价的状态。)
	3. 所有的箱子在“断点”的一边，所有的目标点在另一边。
	4. “断点”的上下格都是墙或者左右格都是墙。
	如果能够找到这样的断点，则程序自动把题目切分成两部分求解，效率有极大提高。
	巧妙利用工具的目标宏功能可以提供不少有用技巧。比如可以人工把通道弄窄以造成“断点”，从而解出以前不能解出的关卡。又如，很多大型关卡的局部是“突围”问题或者是“目标点到位问题”，这时可以自己构造一个带“断点”的关卡，断点一边是非常容易求解的，另一边则是拷贝过来的难题局部，这样就可以利用工具求解这个局部了。


	